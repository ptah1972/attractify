<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Redesigned Page with Embedded Voiceflow Chat</title>
    <!-- Tailwind CSS CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="https://github.com/ptah1972/jda_original/blob/main/styles.css" />
  </head>

  <body class="bg-gray-100 text-gray-700 font-sans">
    <div class="container mx-auto p-4">
      <!-- Page Header -->
      <header class="mb-6">
        <h1 class="text-3xl font-bold mb-2">Create Vacancy</h1>
        <p class="text-gray-600">
          Complete the form below to create a new vacancy.
        </p>
      </header>

      <!-- Main Content & Embedded Chat Sidebar -->
      <div class="flex flex-col lg:flex-row">
        
        <!-- Main Form (about 55.56% on large screens) -->
        <main
          class="w-full lg:w-[55.56%] bg-white rounded-lg shadow-lg p-6 mb-6 lg:mb-0 lg:mr-6"
        >
          <form>
            <!-- Basic Details Section -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Basic Details</h2>
              <div class="mb-4">
                <label for="jobTitle" class="block mb-1 font-medium"
                  >Job Title</label
                >
                <input
                  type="text"
                  id="jobTitle"
                  name="jobTitle"
                  class="w-full border border-gray-300 rounded p-2"
                />
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                  <label for="liveDate" class="block mb-1 font-medium"
                    >Live Date (DD/MM/YYYY)</label
                  >
                  <input
                    type="date"
                    id="liveDate"
                    name="liveDate"
                    class="w-full border border-gray-300 rounded p-2"
                  />
                </div>
                <div>
                  <label
                    for="closingDate"
                    class="block mb-1 font-medium"
                    >Closing Date (DD/MM/YYYY)</label
                  >
                  <input
                    type="date"
                    id="closingDate"
                    name="closingDate"
                    class="w-full border border-gray-300 rounded p-2"
                  />
                </div>
              </div>
            </section>

            <!-- Description Section -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Description</h2>
              <p class="text-sm text-gray-500 mb-2">
                Items highlighted in blue will display on the vacancy advert to
                candidates.
              </p>

              <!-- Organization -->
              <div class="mb-4">
                <label for="organization" class="block mb-1 font-medium"
                  >Organization</label
                >
                <select
                  id="organization"
                  name="organization"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="">Morgan Stanley</option>
                  <option value="">Bank of America</option>
                  <option value="">Amazon</option>
                  <option value="">Korn Ferry</option>
                  <option value="">Home Office</option>
                  <option value="">Ministry of Justice</option>
                  <option value="">Department for Work and Pensions</option>
                  <option value="">Metropolitan Police</option>
                  <option value="">Police Scotland</option>
                  <option value="">Essex Police</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <!-- Additional fields (Directorate, Hours, etc.) -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                  <label for="directorate" class="block mb-1 font-medium"
                    >Directorate</label
                  >
                  <select
                    id="directorate"
                    name="directorate"
                    class="w-full border border-gray-300 rounded p-2"
                  >
                    <option value="">Please select</option>
                    <option value="directorate1">Finance</option>
                    <option value="directorate2">Operational Delivery</option>
                    <option value="directorate3">Policy</option>
                    <option value="directorate4">Risk Management</option>
                    <option value="directorate5">Investments</option>
                  </select>
                </div>
                <div>
                  <label for="numRoles" class="block mb-1 font-medium"
                    >Number of Roles</label
                  >
                  <input
                    type="number"
                    id="numRoles"
                    name="numRoles"
                    class="w-full border border-gray-300 rounded p-2"
                  />
                </div>
                <div>
                  <label for="hours" class="block mb-1 font-medium"
                    >Hours</label
                  >
                  <input
                    type="text"
                    id="hours"
                    name="hours"
                    placeholder="e.g. 37"
                    class="w-full border border-gray-300 rounded p-2"
                  />
                </div>
              </div>

              <!-- Location -->
              <div class="mb-4">
                <label for="location" class="block mb-1 font-medium"
                  >Location(s)</label
                >
                <input
                  type="text"
                  id="location"
                  name="location"
                  class="w-full border border-gray-300 rounded p-2"
                />
              </div>
            </section>

            <!-- Role Details Section -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Role Details</h2>
              <div class="mb-4">
                <label for="positionType" class="block mb-1 font-medium"
                  >Position Type</label
                >
                <select
                  id="positionType"
                  name="positionType"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="">Please select</option>
                  <option value="position1">Permanent</option>
                  <option value="position2">Temporary</option>
                </select>
              </div>
              <div class="mb-4">
                <label for="grade" class="block mb-1 font-medium">Grade</label>
                <select
                  id="grade"
                  name="grade"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="">Please select</option>
                  <option value="grade1">Entry Level</option>
                  <option value="grade2">Associate Level</option>
                  <option value="grade3">Experienced Level</option>
                  <option value="grade4">Senior Level</option>
                  <option value="grade5">Executive Officer</option>
                  <option value="grade6">Higher Executive Officer</option>
                </select>
              </div>
            </section>

            <!-- Advert Section -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Advert</h2>
              <div class="mb-4">
                <label
                  for="advertMethod"
                  class="block mb-1 font-medium"
                  >Advertising Method</label
                >
                <select
                  id="advertMethod"
                  name="advertMethod"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="">Please select</option>
                  <option value="website">Website</option>
                  <option value="internal">Internal</option>
                </select>
              </div>
              <div class="mb-4">
                <label
                  for="advertWording"
                  class="block mb-1 font-medium"
                  >Advert Wording</label
                >
                <textarea
                  id="advertWording"
                  name="advertWording"
                  rows="5"
                  class="w-full border border-gray-300 rounded p-2"
                  placeholder="Please include advert wording or key points and benefits to be included..."
                ></textarea>
              </div>
            </section>

            <!-- Pre Application Knock Out Questions Section -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">
                Pre-Application Questions
              </h2>
              <div class="mb-4">
                <label for="preAppQuestions" class="block mb-1 font-medium"
                  >Do you require pre-application knockout questions?</label
                >
                <select
                  id="preAppQuestions"
                  name="preAppQuestions"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
              <div class="text-sm text-gray-500">
                </ul>
              </div>
            </section>

            <!-- Qualifications & Registrations -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">
                Qualifications and Registrations
              </h2>
              <div class="mb-4">
                <label
                  for="jobSpecificQuals"
                  class="block mb-1 font-medium"
                  >Job specific qualifications required?</label
                >
                <select
                  id="jobSpecificQuals"
                  name="jobSpecificQuals"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
            </section>

            <!-- Application Process -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Application Process</h2>
              <div class="mb-4">
                <label
                  for="essentialExperience"
                  class="block mb-1 font-medium"
                  >Essential experience / skills?</label
                >
                <input
                  type="text"
                  id="essentialExperience"
                  name="essentialExperience"
                  class="w-full border border-gray-300 rounded p-2"
                />
              </div>
            </section>

            <!-- Pre Employment Checks -->
            <section class="mb-8">
              <h2 class="text-xl font-semibold mb-4">Pre Employment Checks</h2>
              <div class="mb-4">
                <label for="dbsCheck" class="block mb-1 font-medium"
                  >DBS Check</label
                >
                <select
                  id="dbsCheck"
                  name="dbsCheck"
                  class="w-full border border-gray-300 rounded p-2"
                >
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
            </section>

            <!-- Form Actions -->
            <div>
              <button
                type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
              >
                Create Vacancy
              </button>
              <button
                type="button"
                class="ml-2 bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400"
              >
                Cancel
              </button>
            </div>
          </form>
        </main>

     
      </div>
    </div>

    <!-- Voiceflow Embedded Chat Script -->
    <script type="text/javascript">
      // Define the SVG if you need it for any UI purpose
      const SVG_Thumb = `<svg width="24px" height="24px" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.29398 20.4966C4.56534 20.4966 4 19.8827 4 19.1539V12.3847C4 11.6559 4.56534 11.042 5.29398 11.042H8.12364L10.8534 4.92738C10.9558 4.69809 11.1677 4.54023 11.4114 4.50434L11.5175 4.49658C12.3273 4.49658 13.0978 4.85402 13.6571 5.48039C14.2015 6.09009 14.5034 6.90649 14.5034 7.7535L14.5027 8.92295L18.1434 8.92346C18.6445 8.92346 19.1173 9.13931 19.4618 9.51188L19.5612 9.62829C19.8955 10.0523 20.0479 10.6054 19.9868 11.1531L19.1398 18.742C19.0297 19.7286 18.2529 20.4966 17.2964 20.4966H8.69422H5.29398ZM11.9545 6.02658L9.41727 11.7111L9.42149 11.7693L9.42091 19.042H17.2964C17.4587 19.042 17.6222 18.8982 17.6784 18.6701L17.6942 18.5807L18.5412 10.9918C18.5604 10.8194 18.5134 10.6486 18.4189 10.5287C18.3398 10.4284 18.2401 10.378 18.1434 10.378H13.7761C13.3745 10.378 13.0488 10.0524 13.0488 9.65073V7.7535C13.0488 7.2587 12.8749 6.78825 12.5721 6.44915C12.4281 6.28794 12.2615 6.16343 12.0824 6.07923L11.9545 6.02658ZM7.96636 12.4966H5.45455V19.042H7.96636V12.4966Z" fill="white"></path>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M5.29398 20.4966C4.56534 20.4966 4 19.8827 4 19.1539V12.3847C4 11.6559 4.56534 11.042 5.29398 11.042H8.12364L10.8534 4.92738C10.9558 4.69809 11.1677 4.54023 11.4114 4.50434L11.5175 4.49658C12.3273 4.49658 13.0978 4.85402 13.6571 5.48039C14.2015 6.09009 14.5034 6.90649 14.5034 7.7535L14.5027 8.92295L18.1434 8.92346C18.6445 8.92346 19.1173 9.13931 19.4618 9.51188L19.5612 9.62829C19.8955 10.0523 20.0479 10.6054 19.9868 11.1531L19.1398 18.742C19.0297 19.7286 18.2529 20.4966 17.2964 20.4966H8.69422H5.29398ZM11.9545 6.02658L9.41727 11.7111L9.42149 11.7693L9.42091 19.042H17.2964C17.4587 19.042 17.6222 18.8982 17.6784 18.6701L17.6942 18.5807L18.5412 10.9918C18.5604 10.8194 18.5134 10.6486 18.4189 10.5287C18.3398 10.4284 18.2401 10.378 18.1434 10.378H13.7761C13.3745 10.378 13.0488 10.0524 13.0488 9.65073V7.7535C13.0488 7.2587 12.8749 6.78825 12.5721 6.44915C12.4281 6.28794 12.2615 6.16343 12.0824 6.07923L11.9545 6.02658ZM7.96636 12.4966H5.45455V19.042H7.96636V12.4966Z" fill="currentColor"></path>
      </svg>`;
    
      // Define the DisableInputExtension
      const DisableInputExtension = {
        name: 'DisableInput',
        type: 'effect',
        match: ({ trace }) =>
          trace.type === 'ext_disableInput' ||
          trace.payload?.name === 'ext_disableInput',
        effect: ({ trace }) => {
          console.log(trace);
          const { isDisabled } = trace.payload;
    
          function disableInput() {
            const chatDiv = document.getElementById('voiceflow-chat');
            if (chatDiv) {
              const shadowRoot = chatDiv.shadowRoot;
              if (shadowRoot) {
                const chatInput = shadowRoot.querySelector('.vfrc-chat-input');
                console.log("chatInput is:");
                console.log(chatInput);
                const textarea = shadowRoot.querySelector('.vfrc-chat-input');
                console.log("textarea is:");
                console.log(textarea);
                const button = shadowRoot.querySelector('.vfrc-button[id^="vfrc-send-message"]');
                console.log("button is:");
                console.log(button);
  
                if (chatInput && textarea && button) {
                  // Insert style tag if not already present
                  let styleTag = shadowRoot.querySelector('#vf-disable-input-style');
                  if (!styleTag) {
                    styleTag = document.createElement('style');
                    styleTag.id = 'vf-disable-input-style';
                    styleTag.textContent = `
                      .vf-no-border, .vf-no-border * {
                        border: none !important;
                      }
                      .vf-hide-button {
                        display: none !important;
                      }
                    `;
                    shadowRoot.appendChild(styleTag);
                  }
    
                  function updateInputState() {
                    textarea.disabled = isDisabled;
                    if (!isDisabled) {
                      textarea.placeholder = 'Message...';
                      chatInput.classList.remove('vf-no-border');
                      button.classList.remove('vf-hide-button');
                      // Restore original getter/setter for value
                      Object.defineProperty(textarea, 'value', originalValueDescriptor);
                    } else {
                      textarea.placeholder = '';
                      chatInput.classList.add('vf-no-border');
                      button.classList.add('vf-hide-button');
                      Object.defineProperty(textarea, 'value', {
                        get: function () {
                          return '';
                        },
                        configurable: true,
                      });
                    }
                    // Dispatch events to update component state
                    textarea.dispatchEvent(new Event('input', { bubbles: true, cancelable: true }));
                    textarea.dispatchEvent(new Event('change', { bubbles: true, cancelable: true }));
                  }
    
                  // Store original value descriptor
                  const originalValueDescriptor = Object.getOwnPropertyDescriptor(
                    HTMLTextAreaElement.prototype,
                    'value'
                  );
                  updateInputState();
                } else {
                  console.error('Chat input, textarea, or button not found');
                }
              } else {
                console.error('Shadow root not found');
              }
            } else {
              console.error('Chat div not found');
            }
          }
          disableInput();
        },
      };
    </script>
    <script type="text/javascript">
      // Load the Voiceflow widget with the custom extension and proactive messaging
      (function(d, t) {
        var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
        v.onload = function() {
          window.voiceflow.chat.load({
            verify: { projectID: '6780d3868259b83ec49aa474' },
            url: 'https://general-runtime.voiceflow.com',
            versionID: 'production',
            voice: { url: "https://runtime-api.voiceflow.com" },
            assistant: {
                  extensions: [DisableInputExtension]
              }
          }).then(() => {
            // Clear any existing proactive messages and push the Amazon messages
            window.voiceflow.chat.proactive.clear();
            window.voiceflow.chat.proactive.push(
              { 
                type: 'text', 
                payload: { message: "Hi there 👋 I'm OleeoQ, your Vacancy Creation Assistant" }
              },
              { 
                type: 'text', 
                payload: { message: "Click on the 'Click here to Get Help' button to get help with creating your job title, job description and generating advertising content" }
              }
            );
          });
        };
        // Use the updated bundle URL for proactive messaging
        v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; 
        v.type = "text/javascript"; 
        s.parentNode.insertBefore(v, s);
      })(document, 'script');
    </script>

  </body>
</html>
